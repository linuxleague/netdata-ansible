---

- name: Remove Netdata repo key.
  apt_key:
    url: https://packagecloud.io/netdata/netdata-repoconfig/gpgkey
    state: absent

- name: remove Netdata packages
  apt:
    state: absent
    purge: True
    name:
      - netdata
      - netdata-repo

- name: Remove the remains
  file:
    path: "{{ item }}"
    state: absent
  with_items:
    - /var/log/netdata
    - /var/lib/netdata
    - /var/cache/netdata
    - /usr/libexec/netdata
   

    #- name: Install some essential packages
    #  apt:
    #    name: "{{ item }}"
    #    update_cache: yes
    #  loop:
    #    - debian-archive-keyring
    #    - apt-transport-https

#- name: add Debian 11 Netdata repo
#  apt_repository: 
#  #repo: deb https://packagecloud.io/netdata/netdata/packages/debian/bullseye/netdata-repo_1-1_all.deb/download.deb bullseye main
#    repo: deb https://packagecloud.io/netdata/netdata-repoconfig/packages/debian/bullseye/netdata-repo_1-1_all.deb/download.deb
#    state: present
#    update_cache: True
